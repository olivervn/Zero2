import base64
myscript = """IyEvdXNyL2Jpbi9lbnYgcHl0aG9uCiMgU0VDVVJFQVVUSCBMQUJTLiBDb3B5cmlnaHQgMjAxOCBTZWN1cmVBdXRoIENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgVGhpcyBzb2Z0d2FyZSBpcyBwcm92aWRlZCB1bmRlciB1bmRlciBhIHNsaWdodGx5IG1vZGlmaWVkIHZlcnNpb24KIyBvZiB0aGUgQXBhY2hlIFNvZnR3YXJlIExpY2Vuc2UuIFNlZSB0aGUgYWNjb21wYW55aW5nIExJQ0VOU0UgZmlsZQojIGZvciBtb3JlIGluZm9ybWF0aW9uLgojCiMgUFNFWEVDIGxpa2UgZnVuY3Rpb25hbGl0eSBleGFtcGxlIHVzaW5nIFJlbUNvbVN2YyAoaHR0cHM6Ly9naXRodWIuY29tL2thdmlrYTEzL1JlbUNvbSkKIwojIEF1dGhvcjoKIyAgYmV0byAoQGFnc29saW5vKQojCiMgUmVmZXJlbmNlIGZvcjoKIyAgRENFL1JQQyBhbmQgU01CLgoKaW1wb3J0IHN5cwppbXBvcnQgb3MKaW1wb3J0IGNtZAppbXBvcnQgbG9nZ2luZwpmcm9tIHRocmVhZGluZyBpbXBvcnQgVGhyZWFkLCBMb2NrCmltcG9ydCBhcmdwYXJzZQppbXBvcnQgcmFuZG9tCmltcG9ydCBzdHJpbmcKaW1wb3J0IHRpbWUKZnJvbSBzaXggaW1wb3J0IFBZMwoKZnJvbSBpbXBhY2tldC5leGFtcGxlcyBpbXBvcnQgbG9nZ2VyCmZyb20gaW1wYWNrZXQgaW1wb3J0IHZlcnNpb24sIHNtYgpmcm9tIGltcGFja2V0LnNtYmNvbm5lY3Rpb24gaW1wb3J0IFNNQkNvbm5lY3Rpb24KZnJvbSBpbXBhY2tldC5kY2VycGMudjUgaW1wb3J0IHRyYW5zcG9ydApmcm9tIGltcGFja2V0LnN0cnVjdHVyZSBpbXBvcnQgU3RydWN0dXJlCmZyb20gaW1wYWNrZXQuZXhhbXBsZXMgaW1wb3J0IHJlbWNvbXN2Yywgc2VydmljZWluc3RhbGwKZnJvbSBpbXBhY2tldC5rcmI1LmtleXRhYiBpbXBvcnQgS2V5dGFiCgoKY2xhc3MgUmVtQ29tTWVzc2FnZShTdHJ1Y3R1cmUpOgogICAgc3RydWN0dXJlID0gKAogICAgICAgICgnQ29tbWFuZCcsJzQwOTZzPSIiJyksCiAgICAgICAgKCdXb3JraW5nRGlyJywnMjYwcz0iIicpLAogICAgICAgICgnUHJpb3JpdHknLCc8TD0weDIwJyksCiAgICAgICAgKCdQcm9jZXNzSUQnLCc8TD0weDAxJyksCiAgICAgICAgKCdNYWNoaW5lJywnMjYwcz0iIicpLAogICAgICAgICgnTm9XYWl0JywnPEw9MCcpLAogICAgKQoKY2xhc3MgUmVtQ29tUmVzcG9uc2UoU3RydWN0dXJlKToKICAgIHN0cnVjdHVyZSA9ICgKICAgICAgICAoJ0Vycm9yQ29kZScsJzxMPTAnKSwKICAgICAgICAoJ1JldHVybkNvZGUnLCc8TD0wJyksCiAgICApCgpSZW1Db21TVERPVVQgICAgICAgICA9ICJSZW1Db21fc3Rkb3V0IgpSZW1Db21TVERJTiAgICAgICAgICA9ICJSZW1Db21fc3RkaW4iClJlbUNvbVNUREVSUiAgICAgICAgID0gIlJlbUNvbV9zdGRlcnIiCgpsb2NrID0gTG9jaygpCgpjbGFzcyBQU0VYRUM6CiAgICBkZWYgX19pbml0X18oc2VsZiwgY29tbWFuZCwgcGF0aCwgZXhlRmlsZSwgY29weUZpbGUsIHBvcnQ9NDQ1LAogICAgICAgICAgICAgICAgIHVzZXJuYW1lPScnLCBwYXNzd29yZD0nJywgZG9tYWluPScnLCBoYXNoZXM9Tm9uZSwgYWVzS2V5PU5vbmUsIGRvS2VyYmVyb3M9RmFsc2UsIGtkY0hvc3Q9Tm9uZSwgc2VydmljZU5hbWU9Tm9uZSwKICAgICAgICAgICAgICAgICByZW1vdGVCaW5hcnlOYW1lPU5vbmUpOgogICAgICAgIHNlbGYuX191c2VybmFtZSA9IHVzZXJuYW1lCiAgICAgICAgc2VsZi5fX3Bhc3N3b3JkID0gcGFzc3dvcmQKICAgICAgICBzZWxmLl9fcG9ydCA9IHBvcnQKICAgICAgICBzZWxmLl9fY29tbWFuZCA9IGNvbW1hbmQKICAgICAgICBzZWxmLl9fcGF0aCA9IHBhdGgKICAgICAgICBzZWxmLl9fZG9tYWluID0gZG9tYWluCiAgICAgICAgc2VsZi5fX2xtaGFzaCA9ICcnCiAgICAgICAgc2VsZi5fX250aGFzaCA9ICcnCiAgICAgICAgc2VsZi5fX2Flc0tleSA9IGFlc0tleQogICAgICAgIHNlbGYuX19leGVGaWxlID0gZXhlRmlsZQogICAgICAgIHNlbGYuX19jb3B5RmlsZSA9IGNvcHlGaWxlCiAgICAgICAgc2VsZi5fX2RvS2VyYmVyb3MgPSBkb0tlcmJlcm9zCiAgICAgICAgc2VsZi5fX2tkY0hvc3QgPSBrZGNIb3N0CiAgICAgICAgc2VsZi5fX3NlcnZpY2VOYW1lID0gc2VydmljZU5hbWUKICAgICAgICBzZWxmLl9fcmVtb3RlQmluYXJ5TmFtZSA9IHJlbW90ZUJpbmFyeU5hbWUKICAgICAgICBpZiBoYXNoZXMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHNlbGYuX19sbWhhc2gsIHNlbGYuX19udGhhc2ggPSBoYXNoZXMuc3BsaXQoJzonKQoKICAgIGRlZiBydW4oc2VsZiwgcmVtb3RlTmFtZSwgcmVtb3RlSG9zdCk6CgogICAgICAgIHN0cmluZ2JpbmRpbmcgPSByJ25jYWNuX25wOiVzW1xwaXBlXHN2Y2N0bF0nICUgcmVtb3RlTmFtZQogICAgICAgIGxvZ2dpbmcuZGVidWcoJ1N0cmluZ0JpbmRpbmcgJXMnJXN0cmluZ2JpbmRpbmcpCiAgICAgICAgcnBjdHJhbnNwb3J0ID0gdHJhbnNwb3J0LkRDRVJQQ1RyYW5zcG9ydEZhY3Rvcnkoc3RyaW5nYmluZGluZykKICAgICAgICBycGN0cmFuc3BvcnQuc2V0X2Rwb3J0KHNlbGYuX19wb3J0KQogICAgICAgIHJwY3RyYW5zcG9ydC5zZXRSZW1vdGVIb3N0KHJlbW90ZUhvc3QpCgogICAgICAgIGlmIGhhc2F0dHIocnBjdHJhbnNwb3J0LCAnc2V0X2NyZWRlbnRpYWxzJyk6CiAgICAgICAgICAgICMgVGhpcyBtZXRob2QgZXhpc3RzIG9ubHkgZm9yIHNlbGVjdGVkIHByb3RvY29sIHNlcXVlbmNlcy4KICAgICAgICAgICAgcnBjdHJhbnNwb3J0LnNldF9jcmVkZW50aWFscyhzZWxmLl9fdXNlcm5hbWUsIHNlbGYuX19wYXNzd29yZCwgc2VsZi5fX2RvbWFpbiwgc2VsZi5fX2xtaGFzaCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9fbnRoYXNoLCBzZWxmLl9fYWVzS2V5KQoKICAgICAgICBycGN0cmFuc3BvcnQuc2V0X2tlcmJlcm9zKHNlbGYuX19kb0tlcmJlcm9zLCBzZWxmLl9fa2RjSG9zdCkKICAgICAgICBzZWxmLmRvU3R1ZmYocnBjdHJhbnNwb3J0KQoKICAgIGRlZiBvcGVuUGlwZShzZWxmLCBzLCB0aWQsIHBpcGUsIGFjY2Vzc01hc2spOgogICAgICAgIHBpcGVSZWFkeSA9IEZhbHNlCiAgICAgICAgdHJpZXMgPSA1MAogICAgICAgIHdoaWxlIHBpcGVSZWFkeSBpcyBGYWxzZSBhbmQgdHJpZXMgPiAwOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzLndhaXROYW1lZFBpcGUodGlkLHBpcGUpCiAgICAgICAgICAgICAgICBwaXBlUmVhZHkgPSBUcnVlCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHRyaWVzIC09IDEKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMikKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgaWYgdHJpZXMgPT0gMDoKICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCdQaXBlIG5vdCByZWFkeSwgYWJvcnRpbmcnKQoKICAgICAgICBmaWQgPSBzLm9wZW5GaWxlKHRpZCxwaXBlLGFjY2Vzc01hc2ssIGNyZWF0aW9uT3B0aW9uID0gMHg0MCwgZmlsZUF0dHJpYnV0ZXMgPSAweDgwKQoKICAgICAgICByZXR1cm4gZmlkCgogICAgZGVmIGRvU3R1ZmYoc2VsZiwgcnBjdHJhbnNwb3J0KToKCiAgICAgICAgZGNlID0gcnBjdHJhbnNwb3J0LmdldF9kY2VfcnBjKCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIGRjZS5jb25uZWN0KCkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGlmIGxvZ2dpbmcuZ2V0TG9nZ2VyKCkubGV2ZWwgPT0gbG9nZ2luZy5ERUJVRzoKICAgICAgICAgICAgICAgIGltcG9ydCB0cmFjZWJhY2sKICAgICAgICAgICAgICAgIHRyYWNlYmFjay5wcmludF9leGMoKQogICAgICAgICAgICBsb2dnaW5nLmNyaXRpY2FsKHN0cihlKSkKICAgICAgICAgICAgc3lzLmV4aXQoMSkKCiAgICAgICAgZ2xvYmFsIGRpYWxlY3QKICAgICAgICBkaWFsZWN0ID0gcnBjdHJhbnNwb3J0LmdldF9zbWJfY29ubmVjdGlvbigpLmdldERpYWxlY3QoKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVuSW5zdGFsbGVkID0gRmFsc2UKICAgICAgICAgICAgcyA9IHJwY3RyYW5zcG9ydC5nZXRfc21iX2Nvbm5lY3Rpb24oKQoKICAgICAgICAgICAgIyBXZSBkb24ndCB3YW5uYSBkZWFsIHdpdGggdGltZW91dHMgZnJvbSBub3cgb24uCiAgICAgICAgICAgIHMuc2V0VGltZW91dCgxMDAwMDApCiAgICAgICAgICAgIGlmIHNlbGYuX19leGVGaWxlIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBpbnN0YWxsU2VydmljZSA9IHNlcnZpY2VpbnN0YWxsLlNlcnZpY2VJbnN0YWxsKHJwY3RyYW5zcG9ydC5nZXRfc21iX2Nvbm5lY3Rpb24oKSwgcmVtY29tc3ZjLlJlbUNvbVN2YygpLCBzZWxmLl9fc2VydmljZU5hbWUsIHNlbGYuX19yZW1vdGVCaW5hcnlOYW1lKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGYgPSBvcGVuKHNlbGYuX19leGVGaWxlLCAncmInKQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgIGxvZ2dpbmcuY3JpdGljYWwoc3RyKGUpKQogICAgICAgICAgICAgICAgICAgIHN5cy5leGl0KDEpCiAgICAgICAgICAgICAgICBpbnN0YWxsU2VydmljZSA9IHNlcnZpY2VpbnN0YWxsLlNlcnZpY2VJbnN0YWxsKHJwY3RyYW5zcG9ydC5nZXRfc21iX2Nvbm5lY3Rpb24oKSwgZikKCiAgICAgICAgICAgIGlmIGluc3RhbGxTZXJ2aWNlLmluc3RhbGwoKSBpcyBGYWxzZToKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgaWYgc2VsZi5fX2V4ZUZpbGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBmLmNsb3NlKCkKCiAgICAgICAgICAgICMgQ2hlY2sgaWYgd2UgbmVlZCB0byBjb3B5IGEgZmlsZSBmb3IgZXhlY3V0aW9uCiAgICAgICAgICAgIGlmIHNlbGYuX19jb3B5RmlsZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIGluc3RhbGxTZXJ2aWNlLmNvcHlfZmlsZShzZWxmLl9fY29weUZpbGUsIGluc3RhbGxTZXJ2aWNlLmdldFNoYXJlKCksIG9zLnBhdGguYmFzZW5hbWUoc2VsZi5fX2NvcHlGaWxlKSkKICAgICAgICAgICAgICAgICMgQW5kIHdlIGNoYW5nZSB0aGUgY29tbWFuZCB0byBiZSBleGVjdXRlZCB0byB0aGlzIGZpbGVuYW1lCiAgICAgICAgICAgICAgICBzZWxmLl9fY29tbWFuZCA9IG9zLnBhdGguYmFzZW5hbWUoc2VsZi5fX2NvcHlGaWxlKSArICcgJyArIHNlbGYuX19jb21tYW5kCgogICAgICAgICAgICB0aWQgPSBzLmNvbm5lY3RUcmVlKCdJUEMkJykKICAgICAgICAgICAgZmlkX21haW4gPSBzZWxmLm9wZW5QaXBlKHMsdGlkLHInXFJlbUNvbV9jb21tdW5pY2F0b24nLDB4MTIwMTlmKQoKICAgICAgICAgICAgcGFja2V0ID0gUmVtQ29tTWVzc2FnZSgpCiAgICAgICAgICAgIHBpZCA9IG9zLmdldHBpZCgpCgogICAgICAgICAgICBwYWNrZXRbJ01hY2hpbmUnXSA9ICcnLmpvaW4oW3JhbmRvbS5jaG9pY2Uoc3RyaW5nLmFzY2lpX2xldHRlcnMpIGZvciBfIGluIHJhbmdlKDQpXSkKICAgICAgICAgICAgaWYgc2VsZi5fX3BhdGggaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBwYWNrZXRbJ1dvcmtpbmdEaXInXSA9IHNlbGYuX19wYXRoCiAgICAgICAgICAgIHBhY2tldFsnQ29tbWFuZCddID0gc2VsZi5fX2NvbW1hbmQKICAgICAgICAgICAgcGFja2V0WydQcm9jZXNzSUQnXSA9IHBpZAoKICAgICAgICAgICAgcy53cml0ZU5hbWVkUGlwZSh0aWQsIGZpZF9tYWluLCBwYWNrZXQuZ2V0RGF0YSgpKQoKICAgICAgICAgICAgIyBIZXJlIHdlJ2xsIHN0b3JlIHRoZSBjb21tYW5kIHdlIHR5cGUgc28gd2UgZG9uJ3QgcHJpbnQgaXQgYmFjayA7KQogICAgICAgICAgICAjICggSSBrbm93Li4gZ2xvYmFscyBhcmUgbmFzdHkgOlAgKQogICAgICAgICAgICBnbG9iYWwgTGFzdERhdGFTZW50CiAgICAgICAgICAgIExhc3REYXRhU2VudCA9ICcnCgogICAgICAgICAgICAjIENyZWF0ZSB0aGUgcGlwZXMgdGhyZWFkcwogICAgICAgICAgICBzdGRpbl9waXBlID0gUmVtb3RlU3RkSW5QaXBlKHJwY3RyYW5zcG9ydCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByJ1wlcyVzJWQnICUgKFJlbUNvbVNURElOLCBwYWNrZXRbJ01hY2hpbmUnXSwgcGFja2V0WydQcm9jZXNzSUQnXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc21iLkZJTEVfV1JJVEVfREFUQSB8IHNtYi5GSUxFX0FQUEVORF9EQVRBLCBpbnN0YWxsU2VydmljZS5nZXRTaGFyZSgpKQogICAgICAgICAgICBzdGRpbl9waXBlLnN0YXJ0KCkKICAgICAgICAgICAgc3Rkb3V0X3BpcGUgPSBSZW1vdGVTdGRPdXRQaXBlKHJwY3RyYW5zcG9ydCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHInXCVzJXMlZCcgJSAoUmVtQ29tU1RET1VULCBwYWNrZXRbJ01hY2hpbmUnXSwgcGFja2V0WydQcm9jZXNzSUQnXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbWIuRklMRV9SRUFEX0RBVEEpCiAgICAgICAgICAgIHN0ZG91dF9waXBlLnN0YXJ0KCkKICAgICAgICAgICAgc3RkZXJyX3BpcGUgPSBSZW1vdGVTdGRFcnJQaXBlKHJwY3RyYW5zcG9ydCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHInXCVzJXMlZCcgJSAoUmVtQ29tU1RERVJSLCBwYWNrZXRbJ01hY2hpbmUnXSwgcGFja2V0WydQcm9jZXNzSUQnXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbWIuRklMRV9SRUFEX0RBVEEpCiAgICAgICAgICAgIHN0ZGVycl9waXBlLnN0YXJ0KCkKCiAgICAgICAgICAgICMgQW5kIHdlIHN0YXkgaGVyZSB0aWxsIHRoZSBlbmQKICAgICAgICAgICAgYW5zID0gcy5yZWFkTmFtZWRQaXBlKHRpZCxmaWRfbWFpbiw4KQoKICAgICAgICAgICAgaWYgbGVuKGFucyk6CiAgICAgICAgICAgICAgICByZXRDb2RlID0gUmVtQ29tUmVzcG9uc2UoYW5zKQogICAgICAgICAgICAgICAgbG9nZ2luZy5pbmZvKCJQcm9jZXNzICVzIGZpbmlzaGVkIHdpdGggRXJyb3JDb2RlOiAlZCwgUmV0dXJuQ29kZTogJWQiICUgKAogICAgICAgICAgICAgICAgc2VsZi5fX2NvbW1hbmQsIHJldENvZGVbJ0Vycm9yQ29kZSddLCByZXRDb2RlWydSZXR1cm5Db2RlJ10pKQogICAgICAgICAgICBpbnN0YWxsU2VydmljZS51bmluc3RhbGwoKQogICAgICAgICAgICBpZiBzZWxmLl9fY29weUZpbGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAjIFdlIGNvcGllZCBhIGZpbGUgZm9yIGV4ZWN1dGlvbiwgbGV0J3MgcmVtb3ZlIGl0CiAgICAgICAgICAgICAgICBzLmRlbGV0ZUZpbGUoaW5zdGFsbFNlcnZpY2UuZ2V0U2hhcmUoKSwgb3MucGF0aC5iYXNlbmFtZShzZWxmLl9fY29weUZpbGUpKQogICAgICAgICAgICB1bkluc3RhbGxlZCA9IFRydWUKICAgICAgICAgICAgc3lzLmV4aXQocmV0Q29kZVsnRXJyb3JDb2RlJ10pCgogICAgICAgIGV4Y2VwdCBTeXN0ZW1FeGl0OgogICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgaWYgbG9nZ2luZy5nZXRMb2dnZXIoKS5sZXZlbCA9PSBsb2dnaW5nLkRFQlVHOgogICAgICAgICAgICAgICAgaW1wb3J0IHRyYWNlYmFjawogICAgICAgICAgICAgICAgdHJhY2ViYWNrLnByaW50X2V4YygpCiAgICAgICAgICAgIGxvZ2dpbmcuZGVidWcoc3RyKGUpKQogICAgICAgICAgICBpZiB1bkluc3RhbGxlZCBpcyBGYWxzZToKICAgICAgICAgICAgICAgIGluc3RhbGxTZXJ2aWNlLnVuaW5zdGFsbCgpCiAgICAgICAgICAgICAgICBpZiBzZWxmLl9fY29weUZpbGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgcy5kZWxldGVGaWxlKGluc3RhbGxTZXJ2aWNlLmdldFNoYXJlKCksIG9zLnBhdGguYmFzZW5hbWUoc2VsZi5fX2NvcHlGaWxlKSkKICAgICAgICAgICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICAgICAgICAgIHN5cy5leGl0KDEpCgpjbGFzcyBQaXBlcyhUaHJlYWQpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHRyYW5zcG9ydCwgcGlwZSwgcGVybWlzc2lvbnMsIHNoYXJlPU5vbmUpOgogICAgICAgIFRocmVhZC5fX2luaXRfXyhzZWxmKQogICAgICAgIHNlbGYuc2VydmVyID0gMAogICAgICAgIHNlbGYudHJhbnNwb3J0ID0gdHJhbnNwb3J0CiAgICAgICAgc2VsZi5jcmVkZW50aWFscyA9IHRyYW5zcG9ydC5nZXRfY3JlZGVudGlhbHMoKQogICAgICAgIHNlbGYudGlkID0gMAogICAgICAgIHNlbGYuZmlkID0gMAogICAgICAgIHNlbGYuc2hhcmUgPSBzaGFyZQogICAgICAgIHNlbGYucG9ydCA9IHRyYW5zcG9ydC5nZXRfZHBvcnQoKQogICAgICAgIHNlbGYucGlwZSA9IHBpcGUKICAgICAgICBzZWxmLnBlcm1pc3Npb25zID0gcGVybWlzc2lvbnMKICAgICAgICBzZWxmLmRhZW1vbiA9IFRydWUKCiAgICBkZWYgY29ubmVjdFBpcGUoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBsb2NrLmFjcXVpcmUoKQogICAgICAgICAgICBnbG9iYWwgZGlhbGVjdAogICAgICAgICAgICAjc2VsZi5zZXJ2ZXIgPSBTTUJDb25uZWN0aW9uKCcqU01CU0VSVkVSJywgc2VsZi50cmFuc3BvcnQuZ2V0X3NtYl9jb25uZWN0aW9uKCkuZ2V0UmVtb3RlSG9zdCgpLCBzZXNzX3BvcnQgPSBzZWxmLnBvcnQsIHByZWZlcnJlZERpYWxlY3QgPSBTTUJfRElBTEVDVCkKICAgICAgICAgICAgc2VsZi5zZXJ2ZXIgPSBTTUJDb25uZWN0aW9uKHNlbGYudHJhbnNwb3J0LmdldF9zbWJfY29ubmVjdGlvbigpLmdldFJlbW90ZU5hbWUoKSwgc2VsZi50cmFuc3BvcnQuZ2V0X3NtYl9jb25uZWN0aW9uKCkuZ2V0UmVtb3RlSG9zdCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vzc19wb3J0PXNlbGYucG9ydCwgcHJlZmVycmVkRGlhbGVjdD1kaWFsZWN0KQogICAgICAgICAgICB1c2VyLCBwYXNzd2QsIGRvbWFpbiwgbG0sIG50LCBhZXNLZXksIFRHVCwgVEdTID0gc2VsZi5jcmVkZW50aWFscwogICAgICAgICAgICBpZiBzZWxmLnRyYW5zcG9ydC5nZXRfa2VyYmVyb3MoKSBpcyBUcnVlOgogICAgICAgICAgICAgICAgc2VsZi5zZXJ2ZXIua2VyYmVyb3NMb2dpbih1c2VyLCBwYXNzd2QsIGRvbWFpbiwgbG0sIG50LCBhZXNLZXksIGtkY0hvc3Q9c2VsZi50cmFuc3BvcnQuZ2V0X2tkY0hvc3QoKSwgVEdUPVRHVCwgVEdTPVRHUykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuc2VydmVyLmxvZ2luKHVzZXIsIHBhc3N3ZCwgZG9tYWluLCBsbSwgbnQpCiAgICAgICAgICAgIGxvY2sucmVsZWFzZSgpCiAgICAgICAgICAgIHNlbGYudGlkID0gc2VsZi5zZXJ2ZXIuY29ubmVjdFRyZWUoJ0lQQyQnKQoKICAgICAgICAgICAgc2VsZi5zZXJ2ZXIud2FpdE5hbWVkUGlwZShzZWxmLnRpZCwgc2VsZi5waXBlKQogICAgICAgICAgICBzZWxmLmZpZCA9IHNlbGYuc2VydmVyLm9wZW5GaWxlKHNlbGYudGlkLHNlbGYucGlwZSxzZWxmLnBlcm1pc3Npb25zLCBjcmVhdGlvbk9wdGlvbiA9IDB4NDAsIGZpbGVBdHRyaWJ1dGVzID0gMHg4MCkKICAgICAgICAgICAgc2VsZi5zZXJ2ZXIuc2V0VGltZW91dCgxMDAwMDAwKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgaWYgbG9nZ2luZy5nZXRMb2dnZXIoKS5sZXZlbCA9PSBsb2dnaW5nLkRFQlVHOgogICAgICAgICAgICAgICAgaW1wb3J0IHRyYWNlYmFjawogICAgICAgICAgICAgICAgdHJhY2ViYWNrLnByaW50X2V4YygpCiAgICAgICAgICAgIGxvZ2dpbmcuZXJyb3IoIlNvbWV0aGluZyB3ZW4ndCB3cm9uZyBjb25uZWN0aW5nIHRoZSBwaXBlcyglcyksIHRyeSBhZ2FpbiIgJSBzZWxmLl9fY2xhc3NfXykKCgpjbGFzcyBSZW1vdGVTdGRPdXRQaXBlKFBpcGVzKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0cmFuc3BvcnQsIHBpcGUsIHBlcm1pc3NzaW9ucyk6CiAgICAgICAgUGlwZXMuX19pbml0X18oc2VsZiwgdHJhbnNwb3J0LCBwaXBlLCBwZXJtaXNzc2lvbnMpCgogICAgZGVmIHJ1bihzZWxmKToKICAgICAgICBzZWxmLmNvbm5lY3RQaXBlKCkKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBhbnMgPSBzZWxmLnNlcnZlci5yZWFkRmlsZShzZWxmLnRpZCxzZWxmLmZpZCwgMCwgMTAyNCkKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGdsb2JhbCBMYXN0RGF0YVNlbnQKICAgICAgICAgICAgICAgICAgICBpZiBhbnMgIT0gTGFzdERhdGFTZW50OgogICAgICAgICAgICAgICAgICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKGFucy5kZWNvZGUoJ2NwNDM3JykpCiAgICAgICAgICAgICAgICAgICAgICAgIHN5cy5zdGRvdXQuZmx1c2goKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICMgRG9uJ3QgZWNobyB3aGF0IEkgc2VudCwgYW5kIGNsZWFyIGl0IHVwCiAgICAgICAgICAgICAgICAgICAgICAgIExhc3REYXRhU2VudCA9ICcnCiAgICAgICAgICAgICAgICAgICAgIyBKdXN0IGluIGNhc2UgdGhpcyBnb3Qgb3V0IG9mIHN5bmMsIGknbSBjbGVhbmluZyBpdCB1cCBpZiB0aGVyZSBhcmUgbW9yZSB0aGFuIDEwIGNoYXJzLAogICAgICAgICAgICAgICAgICAgICMgaXQgd2lsbCBnaXZlIGZhbHNlIHBvc2l0aXZlcyB0aG8uLiB3ZSBzaG91bGQgZmluZCBhIGJldHRlciB3YXkgdG8gaGFuZGxlIHRoaXMuCiAgICAgICAgICAgICAgICAgICAgaWYgTGFzdERhdGFTZW50ID4gMTA6CiAgICAgICAgICAgICAgICAgICAgICAgIExhc3REYXRhU2VudCA9ICcnCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgcGFzcwoKY2xhc3MgUmVtb3RlU3RkRXJyUGlwZShQaXBlcyk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgdHJhbnNwb3J0LCBwaXBlLCBwZXJtaXNzc2lvbnMpOgogICAgICAgIFBpcGVzLl9faW5pdF9fKHNlbGYsIHRyYW5zcG9ydCwgcGlwZSwgcGVybWlzc3Npb25zKQoKICAgIGRlZiBydW4oc2VsZik6CiAgICAgICAgc2VsZi5jb25uZWN0UGlwZSgpCiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgYW5zID0gc2VsZi5zZXJ2ZXIucmVhZEZpbGUoc2VsZi50aWQsc2VsZi5maWQsIDAsIDEwMjQpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBzeXMuc3RkZXJyLndyaXRlKHN0cihhbnMpKQogICAgICAgICAgICAgICAgICAgIHN5cy5zdGRlcnIuZmx1c2goKQogICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgIHBhc3MKCmNsYXNzIFJlbW90ZVNoZWxsKGNtZC5DbWQpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHNlcnZlciwgcG9ydCwgY3JlZGVudGlhbHMsIHRpZCwgZmlkLCBzaGFyZSwgdHJhbnNwb3J0KToKICAgICAgICBjbWQuQ21kLl9faW5pdF9fKHNlbGYsIEZhbHNlKQogICAgICAgIHNlbGYucHJvbXB0ID0gJ1x4MDgnCiAgICAgICAgc2VsZi5zZXJ2ZXIgPSBzZXJ2ZXIKICAgICAgICBzZWxmLnRyYW5zZmVyQ2xpZW50ID0gTm9uZQogICAgICAgIHNlbGYudGlkID0gdGlkCiAgICAgICAgc2VsZi5maWQgPSBmaWQKICAgICAgICBzZWxmLmNyZWRlbnRpYWxzID0gY3JlZGVudGlhbHMKICAgICAgICBzZWxmLnNoYXJlID0gc2hhcmUKICAgICAgICBzZWxmLnBvcnQgPSBwb3J0CiAgICAgICAgc2VsZi50cmFuc3BvcnQgPSB0cmFuc3BvcnQKICAgICAgICBzZWxmLmludHJvID0gJ1shXSBQcmVzcyBoZWxwIGZvciBleHRyYSBzaGVsbCBjb21tYW5kcycKCiAgICBkZWYgY29ubmVjdF90cmFuc2ZlckNsaWVudChzZWxmKToKICAgICAgICAjc2VsZi50cmFuc2ZlckNsaWVudCA9IFNNQkNvbm5lY3Rpb24oJypTTUJTRVJWRVInLCBzZWxmLnNlcnZlci5nZXRSZW1vdGVIb3N0KCksIHNlc3NfcG9ydCA9IHNlbGYucG9ydCwgcHJlZmVycmVkRGlhbGVjdCA9IFNNQl9ESUFMRUNUKQogICAgICAgIHNlbGYudHJhbnNmZXJDbGllbnQgPSBTTUJDb25uZWN0aW9uKCcqU01CU0VSVkVSJywgc2VsZi5zZXJ2ZXIuZ2V0UmVtb3RlSG9zdCgpLCBzZXNzX3BvcnQ9c2VsZi5wb3J0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWZlcnJlZERpYWxlY3Q9ZGlhbGVjdCkKICAgICAgICB1c2VyLCBwYXNzd2QsIGRvbWFpbiwgbG0sIG50LCBhZXNLZXksIFRHVCwgVEdTID0gc2VsZi5jcmVkZW50aWFscwogICAgICAgIGlmIHNlbGYudHJhbnNwb3J0LmdldF9rZXJiZXJvcygpIGlzIFRydWU6CiAgICAgICAgICAgIHNlbGYudHJhbnNmZXJDbGllbnQua2VyYmVyb3NMb2dpbih1c2VyLCBwYXNzd2QsIGRvbWFpbiwgbG0sIG50LCBhZXNLZXksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZGNIb3N0PXNlbGYudHJhbnNwb3J0LmdldF9rZGNIb3N0KCksIFRHVD1UR1QsIFRHUz1UR1MpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi50cmFuc2ZlckNsaWVudC5sb2dpbih1c2VyLCBwYXNzd2QsIGRvbWFpbiwgbG0sIG50KQoKICAgIGRlZiBkb19oZWxwKHNlbGYsIGxpbmUpOgogICAgICAgIHByaW50KCIiIgogbGNkIHtwYXRofSAgICAgICAgICAgICAgICAgLSBjaGFuZ2VzIHRoZSBjdXJyZW50IGxvY2FsIGRpcmVjdG9yeSB0byB7cGF0aH0KIGV4aXQgICAgICAgICAgICAgICAgICAgICAgIC0gdGVybWluYXRlcyB0aGUgc2VydmVyIHByb2Nlc3MgKGFuZCB0aGlzIHNlc3Npb24pCiBwdXQge3NyY19maWxlLCBkc3RfcGF0aH0gICAtIHVwbG9hZHMgYSBsb2NhbCBmaWxlIHRvIHRoZSBkc3RfcGF0aCBSRUxBVElWRSB0byB0aGUgY29ubmVjdGVkIHNoYXJlICglcykKIGdldCB7ZmlsZX0gICAgICAgICAgICAgICAgIC0gZG93bmxvYWRzIHBhdGhuYW1lIFJFTEFUSVZFIHRvIHRoZSBjb25uZWN0ZWQgc2hhcmUgKCVzKSB0byB0aGUgY3VycmVudCBsb2NhbCBkaXIKICEge2NtZH0gICAgICAgICAgICAgICAgICAgIC0gZXhlY3V0ZXMgYSBsb2NhbCBzaGVsbCBjbWQKIiIiICUgKHNlbGYuc2hhcmUsIHNlbGYuc2hhcmUpKQogICAgICAgIHNlbGYuc2VuZF9kYXRhKCdcclxuJywgRmFsc2UpCgogICAgZGVmIGRvX3NoZWxsKHNlbGYsIHMpOgogICAgICAgIG9zLnN5c3RlbShzKQogICAgICAgIHNlbGYuc2VuZF9kYXRhKCdcclxuJykKCiAgICBkZWYgZG9fZ2V0KHNlbGYsIHNyY19wYXRoKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGlmIHNlbGYudHJhbnNmZXJDbGllbnQgaXMgTm9uZToKICAgICAgICAgICAgICAgIHNlbGYuY29ubmVjdF90cmFuc2ZlckNsaWVudCgpCgogICAgICAgICAgICBpbXBvcnQgbnRwYXRoCiAgICAgICAgICAgIGZpbGVuYW1lID0gbnRwYXRoLmJhc2VuYW1lKHNyY19wYXRoKQogICAgICAgICAgICBmaCA9IG9wZW4oZmlsZW5hbWUsJ3diJykKICAgICAgICAgICAgbG9nZ2luZy5pbmZvKCJEb3dubG9hZGluZyAlc1xcJXMiICUgKHNlbGYuc2hhcmUsIHNyY19wYXRoKSkKICAgICAgICAgICAgc2VsZi50cmFuc2ZlckNsaWVudC5nZXRGaWxlKHNlbGYuc2hhcmUsIHNyY19wYXRoLCBmaC53cml0ZSkKICAgICAgICAgICAgZmguY2xvc2UoKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbG9nZ2luZy5jcml0aWNhbChzdHIoZSkpCiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgc2VsZi5zZW5kX2RhdGEoJ1xyXG4nKQoKICAgIGRlZiBkb19wdXQoc2VsZiwgcyk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBzZWxmLnRyYW5zZmVyQ2xpZW50IGlzIE5vbmU6CiAgICAgICAgICAgICAgICBzZWxmLmNvbm5lY3RfdHJhbnNmZXJDbGllbnQoKQogICAgICAgICAgICBwYXJhbXMgPSBzLnNwbGl0KCcgJykKICAgICAgICAgICAgaWYgbGVuKHBhcmFtcykgPiAxOgogICAgICAgICAgICAgICAgc3JjX3BhdGggPSBwYXJhbXNbMF0KICAgICAgICAgICAgICAgIGRzdF9wYXRoID0gcGFyYW1zWzFdCiAgICAgICAgICAgIGVsaWYgbGVuKHBhcmFtcykgPT0gMToKICAgICAgICAgICAgICAgIHNyY19wYXRoID0gcGFyYW1zWzBdCiAgICAgICAgICAgICAgICBkc3RfcGF0aCA9ICcvJwoKICAgICAgICAgICAgc3JjX2ZpbGUgPSBvcy5wYXRoLmJhc2VuYW1lKHNyY19wYXRoKQogICAgICAgICAgICBmaCA9IG9wZW4oc3JjX3BhdGgsICdyYicpCiAgICAgICAgICAgIGYgPSBkc3RfcGF0aCArICcvJyArIHNyY19maWxlCiAgICAgICAgICAgIHBhdGhuYW1lID0gZi5yZXBsYWNlKCcvJywnXFwnKQogICAgICAgICAgICBsb2dnaW5nLmluZm8oIlVwbG9hZGluZyAlcyB0byAlc1xcJXMiICUgKHNyY19maWxlLCBzZWxmLnNoYXJlLCBkc3RfcGF0aCkpCiAgICAgICAgICAgIGlmIFBZMzoKICAgICAgICAgICAgICAgIHNlbGYudHJhbnNmZXJDbGllbnQucHV0RmlsZShzZWxmLnNoYXJlLCBwYXRobmFtZSwgZmgucmVhZCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYudHJhbnNmZXJDbGllbnQucHV0RmlsZShzZWxmLnNoYXJlLCBwYXRobmFtZS5kZWNvZGUoc3lzLnN0ZGluLmVuY29kaW5nKSwgZmgucmVhZCkKICAgICAgICAgICAgZmguY2xvc2UoKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbG9nZ2luZy5lcnJvcihzdHIoZSkpCiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgc2VsZi5zZW5kX2RhdGEoJ1xyXG4nKQoKICAgIGRlZiBkb19sY2Qoc2VsZiwgcyk6CiAgICAgICAgaWYgcyA9PSAnJzoKICAgICAgICAgICAgcHJpbnQob3MuZ2V0Y3dkKCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgb3MuY2hkaXIocykKICAgICAgICBzZWxmLnNlbmRfZGF0YSgnXHJcbicpCgogICAgZGVmIGVtcHR5bGluZShzZWxmKToKICAgICAgICBzZWxmLnNlbmRfZGF0YSgnXHJcbicpCiAgICAgICAgcmV0dXJuCgogICAgZGVmIGRlZmF1bHQoc2VsZiwgbGluZSk6CiAgICAgICAgaWYgUFkzOgogICAgICAgICAgICBzZWxmLnNlbmRfZGF0YShsaW5lLmVuY29kZSgnY3A0MzcnKStiJ1xyXG4nKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuc2VuZF9kYXRhKGxpbmUuZGVjb2RlKHN5cy5zdGRpbi5lbmNvZGluZykuZW5jb2RlKCdjcDQzNycpKydcclxuJykKCiAgICBkZWYgc2VuZF9kYXRhKHNlbGYsIGRhdGEsIGhpZGVPdXRwdXQgPSBUcnVlKToKICAgICAgICBpZiBoaWRlT3V0cHV0IGlzIFRydWU6CiAgICAgICAgICAgIGdsb2JhbCBMYXN0RGF0YVNlbnQKICAgICAgICAgICAgTGFzdERhdGFTZW50ID0gZGF0YQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIExhc3REYXRhU2VudCA9ICcnCiAgICAgICAgc2VsZi5zZXJ2ZXIud3JpdGVGaWxlKHNlbGYudGlkLCBzZWxmLmZpZCwgZGF0YSkKCmNsYXNzIFJlbW90ZVN0ZEluUGlwZShQaXBlcyk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgdHJhbnNwb3J0LCBwaXBlLCBwZXJtaXNzc2lvbnMsIHNoYXJlPU5vbmUpOgogICAgICAgIHNlbGYuc2hlbGwgPSBOb25lCiAgICAgICAgUGlwZXMuX19pbml0X18oc2VsZiwgdHJhbnNwb3J0LCBwaXBlLCBwZXJtaXNzc2lvbnMsIHNoYXJlKQoKICAgIGRlZiBydW4oc2VsZik6CiAgICAgICAgc2VsZi5jb25uZWN0UGlwZSgpCiAgICAgICAgc2VsZi5zaGVsbCA9IFJlbW90ZVNoZWxsKHNlbGYuc2VydmVyLCBzZWxmLnBvcnQsIHNlbGYuY3JlZGVudGlhbHMsIHNlbGYudGlkLCBzZWxmLmZpZCwgc2VsZi5zaGFyZSwgc2VsZi50cmFuc3BvcnQpCiAgICAgICAgc2VsZi5zaGVsbC5jbWRsb29wKCkKCiMgUHJvY2VzcyBjb21tYW5kLWxpbmUgYXJndW1lbnRzLgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgcHJpbnQodmVyc2lvbi5CQU5ORVIpCgogICAgcGFyc2VyID0gYXJncGFyc2UuQXJndW1lbnRQYXJzZXIoYWRkX2hlbHAgPSBUcnVlLCBkZXNjcmlwdGlvbiA9ICJQU0VYRUMgbGlrZSBmdW5jdGlvbmFsaXR5IGV4YW1wbGUgdXNpbmcgUmVtQ29tU3ZjLiIpCgogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgndGFyZ2V0JywgYWN0aW9uPSdzdG9yZScsIGhlbHA9J1tbZG9tYWluL111c2VybmFtZVs6cGFzc3dvcmRdQF08dGFyZ2V0TmFtZSBvciBhZGRyZXNzPicpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCdjb21tYW5kJywgbmFyZ3M9JyonLCBkZWZhdWx0ID0gJyAnLCBoZWxwPSdjb21tYW5kIChvciBhcmd1bWVudHMgaWYgLWMgaXMgdXNlZCkgdG8gZXhlY3V0ZSBhdCAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0aGUgdGFyZ2V0ICh3L28gcGF0aCkgLSAoZGVmYXVsdDpjbWQuZXhlKScpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCctYycsIGFjdGlvbj0nc3RvcmUnLG1ldGF2YXIgPSAicGF0aG5hbWUiLCAgaGVscD0nY29weSB0aGUgZmlsZW5hbWUgZm9yIGxhdGVyIGV4ZWN1dGlvbiwgJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2FyZ3VtZW50cyBhcmUgcGFzc2VkIGluIHRoZSBjb21tYW5kIG9wdGlvbicpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCctcGF0aCcsIGFjdGlvbj0nc3RvcmUnLCBoZWxwPSdwYXRoIG9mIHRoZSBjb21tYW5kIHRvIGV4ZWN1dGUnKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgnLWZpbGUnLCBhY3Rpb249J3N0b3JlJywgaGVscD0iYWx0ZXJuYXRpdmUgUmVtQ29tIGJpbmFyeSAoYmUgc3VyZSBpdCBkb2Vzbid0IHJlcXVpcmUgQ1JUKSIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCctdHMnLCBhY3Rpb249J3N0b3JlX3RydWUnLCBoZWxwPSdhZGRzIHRpbWVzdGFtcCB0byBldmVyeSBsb2dnaW5nIG91dHB1dCcpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCctZGVidWcnLCBhY3Rpb249J3N0b3JlX3RydWUnLCBoZWxwPSdUdXJuIERFQlVHIG91dHB1dCBPTicpCgogICAgZ3JvdXAgPSBwYXJzZXIuYWRkX2FyZ3VtZW50X2dyb3VwKCdhdXRoZW50aWNhdGlvbicpCgogICAgZ3JvdXAuYWRkX2FyZ3VtZW50KCctaGFzaGVzJywgYWN0aW9uPSJzdG9yZSIsIG1ldGF2YXIgPSAiTE1IQVNIOk5USEFTSCIsIGhlbHA9J05UTE0gaGFzaGVzLCBmb3JtYXQgaXMgTE1IQVNIOk5USEFTSCcpCiAgICBncm91cC5hZGRfYXJndW1lbnQoJy1uby1wYXNzJywgYWN0aW9uPSJzdG9yZV90cnVlIiwgaGVscD0nZG9uXCd0IGFzayBmb3IgcGFzc3dvcmQgKHVzZWZ1bCBmb3IgLWspJykKICAgIGdyb3VwLmFkZF9hcmd1bWVudCgnLWsnLCBhY3Rpb249InN0b3JlX3RydWUiLCBoZWxwPSdVc2UgS2VyYmVyb3MgYXV0aGVudGljYXRpb24uIEdyYWJzIGNyZWRlbnRpYWxzIGZyb20gY2NhY2hlIGZpbGUgJwogICAgICAgICAgICAgICAgICAgICAgICcoS1JCNUNDTkFNRSkgYmFzZWQgb24gdGFyZ2V0IHBhcmFtZXRlcnMuIElmIHZhbGlkIGNyZWRlbnRpYWxzIGNhbm5vdCBiZSBmb3VuZCwgaXQgd2lsbCB1c2UgdGhlICcKICAgICAgICAgICAgICAgICAgICAgICAnb25lcyBzcGVjaWZpZWQgaW4gdGhlIGNvbW1hbmQgbGluZScpCiAgICBncm91cC5hZGRfYXJndW1lbnQoJy1hZXNLZXknLCBhY3Rpb249InN0b3JlIiwgbWV0YXZhciA9ICJoZXgga2V5IiwgaGVscD0nQUVTIGtleSB0byB1c2UgZm9yIEtlcmJlcm9zIEF1dGhlbnRpY2F0aW9uICcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcoMTI4IG9yIDI1NiBiaXRzKScpCiAgICBncm91cC5hZGRfYXJndW1lbnQoJy1rZXl0YWInLCBhY3Rpb249InN0b3JlIiwgaGVscD0nUmVhZCBrZXlzIGZvciBTUE4gZnJvbSBrZXl0YWIgZmlsZScpCgogICAgZ3JvdXAgPSBwYXJzZXIuYWRkX2FyZ3VtZW50X2dyb3VwKCdjb25uZWN0aW9uJykKCiAgICBncm91cC5hZGRfYXJndW1lbnQoJy1kYy1pcCcsIGFjdGlvbj0nc3RvcmUnLCBtZXRhdmFyPSJpcCBhZGRyZXNzIiwKICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSdJUCBBZGRyZXNzIG9mIHRoZSBkb21haW4gY29udHJvbGxlci4gSWYgb21pdHRlZCBpdCB3aWxsIHVzZSB0aGUgZG9tYWluIHBhcnQgKEZRRE4pIHNwZWNpZmllZCBpbiAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGhlIHRhcmdldCBwYXJhbWV0ZXInKQogICAgZ3JvdXAuYWRkX2FyZ3VtZW50KCctdGFyZ2V0LWlwJywgYWN0aW9uPSdzdG9yZScsIG1ldGF2YXI9ImlwIGFkZHJlc3MiLAogICAgICAgICAgICAgICAgICAgICAgIGhlbHA9J0lQIEFkZHJlc3Mgb2YgdGhlIHRhcmdldCBtYWNoaW5lLiBJZiBvbWl0dGVkIGl0IHdpbGwgdXNlIHdoYXRldmVyIHdhcyBzcGVjaWZpZWQgYXMgdGFyZ2V0LiAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVGhpcyBpcyB1c2VmdWwgd2hlbiB0YXJnZXQgaXMgdGhlIE5ldEJJT1MgbmFtZSBhbmQgeW91IGNhbm5vdCByZXNvbHZlIGl0JykKICAgIGdyb3VwLmFkZF9hcmd1bWVudCgnLXBvcnQnLCBjaG9pY2VzPVsnMTM5JywgJzQ0NSddLCBuYXJncz0nPycsIGRlZmF1bHQ9JzQ0NScsIG1ldGF2YXI9ImRlc3RpbmF0aW9uIHBvcnQiLAogICAgICAgICAgICAgICAgICAgICAgIGhlbHA9J0Rlc3RpbmF0aW9uIHBvcnQgdG8gY29ubmVjdCB0byBTTUIgU2VydmVyJykKICAgIGdyb3VwLmFkZF9hcmd1bWVudCgnLXNlcnZpY2UtbmFtZScsIGFjdGlvbj0nc3RvcmUnLCBtZXRhdmFyPSJzZXJ2aWNlX25hbWUiLCBkZWZhdWx0ID0gJycsIGhlbHA9J1RoZSBuYW1lIG9mIHRoZSBzZXJ2aWNlJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgdXNlZCB0byB0cmlnZ2VyIHRoZSBwYXlsb2FkJykKICAgIGdyb3VwLmFkZF9hcmd1bWVudCgnLXJlbW90ZS1iaW5hcnktbmFtZScsIGFjdGlvbj0nc3RvcmUnLCBtZXRhdmFyPSJyZW1vdGVfYmluYXJ5X25hbWUiLCBkZWZhdWx0ID0gTm9uZSwgaGVscD0nVGhpcyB3aWxsICcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2JlIHRoZSBuYW1lIG9mIHRoZSBleGVjdXRhYmxlIHVwbG9hZGVkIG9uIHRoZSB0YXJnZXQnKQoKICAgIGlmIGxlbihzeXMuYXJndik9PTE6CiAgICAgICAgcGFyc2VyLnByaW50X2hlbHAoKQogICAgICAgIHN5cy5leGl0KDEpCgogICAgb3B0aW9ucyA9IHBhcnNlci5wYXJzZV9hcmdzKCkKCiAgICAjIEluaXQgdGhlIGV4YW1wbGUncyBsb2dnZXIgdGhlbWUKICAgIGxvZ2dlci5pbml0KG9wdGlvbnMudHMpCgogICAgaWYgb3B0aW9ucy5kZWJ1ZyBpcyBUcnVlOgogICAgICAgIGxvZ2dpbmcuZ2V0TG9nZ2VyKCkuc2V0TGV2ZWwobG9nZ2luZy5ERUJVRykKICAgICAgICAjIFByaW50IHRoZSBMaWJyYXJ5J3MgaW5zdGFsbGF0aW9uIHBhdGgKICAgICAgICBsb2dnaW5nLmRlYnVnKHZlcnNpb24uZ2V0SW5zdGFsbGF0aW9uUGF0aCgpKQogICAgZWxzZToKICAgICAgICBsb2dnaW5nLmdldExvZ2dlcigpLnNldExldmVsKGxvZ2dpbmcuSU5GTykKCiAgICBpbXBvcnQgcmUKCiAgICBkb21haW4sIHVzZXJuYW1lLCBwYXNzd29yZCwgcmVtb3RlTmFtZSA9IHJlLmNvbXBpbGUoJyg/Oig/OihbXi9AOl0qKS8pPyhbXkA6XSopKD86OihbXkBdKikpP0ApPyguKiknKS5tYXRjaCgKICAgICAgICBvcHRpb25zLnRhcmdldCkuZ3JvdXBzKCcnKQoKICAgICNJbiBjYXNlIHRoZSBwYXNzd29yZCBjb250YWlucyAnQCcKICAgIGlmICdAJyBpbiByZW1vdGVOYW1lOgogICAgICAgIHBhc3N3b3JkID0gcGFzc3dvcmQgKyAnQCcgKyByZW1vdGVOYW1lLnJwYXJ0aXRpb24oJ0AnKVswXQogICAgICAgIHJlbW90ZU5hbWUgPSByZW1vdGVOYW1lLnJwYXJ0aXRpb24oJ0AnKVsyXQoKICAgIGlmIGRvbWFpbiBpcyBOb25lOgogICAgICAgIGRvbWFpbiA9ICcnCgogICAgaWYgb3B0aW9ucy5rZXl0YWIgaXMgbm90IE5vbmU6CiAgICAgICAgS2V5dGFiLmxvYWRLZXlzRnJvbUtleXRhYiAob3B0aW9ucy5rZXl0YWIsIHVzZXJuYW1lLCBkb21haW4sIG9wdGlvbnMpCiAgICAgICAgb3B0aW9ucy5rID0gVHJ1ZQoKICAgIGlmIG9wdGlvbnMudGFyZ2V0X2lwIGlzIE5vbmU6CiAgICAgICAgb3B0aW9ucy50YXJnZXRfaXAgPSByZW1vdGVOYW1lCgogICAgaWYgcGFzc3dvcmQgPT0gJycgYW5kIHVzZXJuYW1lICE9ICcnIGFuZCBvcHRpb25zLmhhc2hlcyBpcyBOb25lIGFuZCBvcHRpb25zLm5vX3Bhc3MgaXMgRmFsc2UgYW5kIG9wdGlvbnMuYWVzS2V5IGlzIE5vbmU6CiAgICAgICAgZnJvbSBnZXRwYXNzIGltcG9ydCBnZXRwYXNzCiAgICAgICAgcGFzc3dvcmQgPSBnZXRwYXNzKCJQYXNzd29yZDoiKQoKICAgIGlmIG9wdGlvbnMuYWVzS2V5IGlzIG5vdCBOb25lOgogICAgICAgIG9wdGlvbnMuayA9IFRydWUKCiAgICBjb21tYW5kID0gJyAnLmpvaW4ob3B0aW9ucy5jb21tYW5kKQogICAgaWYgY29tbWFuZCA9PSAnICc6CiAgICAgICAgY29tbWFuZCA9ICdjbWQuZXhlJwoKICAgIGV4ZWN1dGVyID0gUFNFWEVDKGNvbW1hbmQsIG9wdGlvbnMucGF0aCwgb3B0aW9ucy5maWxlLCBvcHRpb25zLmMsIGludChvcHRpb25zLnBvcnQpLCB1c2VybmFtZSwgcGFzc3dvcmQsIGRvbWFpbiwgb3B0aW9ucy5oYXNoZXMsCiAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmFlc0tleSwgb3B0aW9ucy5rLCBvcHRpb25zLmRjX2lwLCBvcHRpb25zLnNlcnZpY2VfbmFtZSwgb3B0aW9ucy5yZW1vdGVfYmluYXJ5X25hbWUpCiAgICBleGVjdXRlci5ydW4ocmVtb3RlTmFtZSwgb3B0aW9ucy50YXJnZXRfaXApCg=="""
eval(compile(base64.b64decode(myscript),'<string>','exec'))